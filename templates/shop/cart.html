<!-- templates/shop/cart.html -->
{% extends 'shop/base.html' %}
{% block content %}
<h1>Shopping Cart</h1>

{% if cart_items %}
<div style="background: white; padding: 2rem; border-radius: 10px; margin-bottom: 2rem;">
    {% for item in cart_items %}
    <div style="display: flex; gap: 2rem; align-items: center; padding: 1rem; border-bottom: 1px solid #eee;">
        <!-- Fixed Image Logic -->
        {% if 'headphone' in item.product.name.lower or 'speaker' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'watch' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 't-shirt' in item.product.name.lower or 'shirt' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'jeans' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1542272604-787c3835535d?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'shoe' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'laptop' in item.product.name.lower or 'stand' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'book' in item.product.name.lower or 'python' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1532012197267-da84d127e765?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'blender' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1585515320310-259814833e62?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'bottle' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1602143407151-7111542de6e8?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'yoga' in item.product.name.lower or 'mat' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'dumbbell' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% elif 'coffee' in item.product.name.lower %}
            <img src="https://images.unsplash.com/photo-1517668808822-9ebb02f2a0e6?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% else %}
            <img src="https://images.unsplash.com/photo-1560393464-5c69a73c5770?w=100&h=100&fit=crop" alt="{{ item.product.name }}" 
                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
        {% endif %}
        
        <div style="flex: 1;">
            <h3>{{ item.product.name }}</h3>
            <p style="color: #e74c3c; font-size: 1.2rem;">₹{{ item.product.price }}</p>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
            <form method="post" action="{% url 'update_cart' item.id %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" name="action" value="decrease" class="btn btn-secondary">-</button>
            </form>
            <span style="font-size: 1.2rem; font-weight: bold;">{{ item.quantity }}</span>
            <form method="post" action="{% url 'update_cart' item.id %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" name="action" value="increase" class="btn">+</button>
            </form>
        </div>
        <p style="font-size: 1.2rem; font-weight: bold;">₹{{ item.get_subtotal }}</p>
        <form method="post" action="{% url 'update_cart' item.id %}">
            {% csrf_token %}
            <button type="submit" name="action" value="remove" class="btn btn-danger">Remove</button>
        </form>
    </div>
    {% endfor %}
    
    <div style="text-align: right; padding: 2rem; font-size: 1.5rem;">
        <strong>Total: ₹{{ total }}</strong>
    </div>
    
    <div style="text-align: right;">
        <a href="{% url 'checkout' %}" class="btn" style="font-size: 1.1rem; padding: 1rem 2rem;">
            Proceed to Checkout
        </a>
    </div>
</div>

{% if recommended_products %}
<h2 style="color: white;">You Might Also Like</h2>
<div class="product-grid">
    {% for product in recommended_products %}
    <div class="product-card">
        {% if 'headphone' in product.name.lower or 'speaker' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'watch' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 't-shirt' in product.name.lower or 'shirt' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'jeans' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1542272604-787c3835535d?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'shoe' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'laptop' in product.name.lower or 'stand' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'book' in product.name.lower or 'python' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1532012197267-da84d127e765?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'blender' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1585515320310-259814833e62?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'bottle' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1602143407151-7111542de6e8?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'yoga' in product.name.lower or 'mat' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'dumbbell' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% elif 'coffee' in product.name.lower %}
            <img src="https://images.unsplash.com/photo-1517668808822-9ebb02f2a0e6?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% else %}
            <img src="https://images.unsplash.com/photo-1560393464-5c69a73c5770?w=250&h=200&fit=crop" alt="{{ product.name }}" class="product-image">
        {% endif %}
        <div class="product-info">
            <h3 class="product-name">{{ product.name }}</h3>
            <p class="product-price">₹{{ product.price }}</p>
            <a href="{% url 'product_detail' product.id %}" class="btn">View Details</a>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

{% else %}
<div style="text-align: center; padding: 3rem; background: white; border-radius: 10px;">
    <h2>Your cart is empty</h2>
    <p style="margin: 1rem 0; color: #7f8c8d;">Add some products to get started!</p>
    <a href="{% url 'product_list' %}" class="btn">Browse Products</a>
</div>
{% endif %}
{% endblock %}